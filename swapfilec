#!/bin/bash
#---------------------------------------------------------------------------------------------------------------#
# swapfile creation utlity                                                                                      #
# This script is licenced under GPLv3 ; you can get your copy from https://www.gnu.org/licenses/gpl-3.0.en.html #
# (C) Omkar Dhekne ; ogdhekne@yahoo.in ; github: https://github.com/ogdhekne                                    #
#---------------------------------------------------------------------------------------------------------------#

# Environment variables:
  location="$2"
  size="$3"

# Functions:

  # Create Swapfile
  create()
  {
  dd if=/dev/zero of=$location bs=1 count=0 seek=$size

  chmod 0600 $location

  mkswap $location

  swapon $location

  echo "$location none            swap    sw              0       0" | tee --append /etc/fstab

  echo "vm.swappiness=100" | tee --append /etc/sysctl.conf

  sysctl -p

  swapon -s

  free -m

  echo -e  "\n DONE"
  }

  # Delete Swapfile.
  delete()
  {
  swapoff $location

  sed --in-place '/swap/d' /etc/fstab

  rm -rf $location

  sed --in-place '/swappiness/d' /etc/sysctl.conf

  free -m

  echo -e  "\n DONE"
  }

  # Print Help.
  help()
  {
  cat <<EOF
  +---------------------+
  +  Swapfile Utility:  +
  +---------------------+

  create:  $0 create /swap 1G
  delete:  $0 delete /swap
  help:    $0 help
EOF
  }

# Execute functions:
  # If no commandline argument is passed then print help.
  if [[ -z $1 ]]
  then
    help
  else
    $1
  fi
